<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple Form</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
  <script src="https://smtpjs.com/v3/smtp.js"></script>
</head>
<style>
  :root{
    --blue-color: #0d6efd;
  }

  .required {
    color: red;
  }

  .bg-blue{
    background: var(--blue-color);
  }

  .form-control:hover, .form-control:focus{
    border-color:var(--blue-color);
    box-shadow: none;
  }

  .img-size{
    width: 250px;
    height: auto;
  }

  .error-block{
    width: 100%;
    margin-top: 0.25rem;
    font-size: .875em;
    color: #dc3545;
  }

  .form-control.danger{
    border-color: red;
  }

</style>
<body>
  <h2 class='text-center mt-3'> Simple Form </h2>
  <div class='row ms-3'>
    <div class='col-md-5'>
      <form id='simple-form' novalidate>
        <div class="mb-3">
          <label for="first-name" class="form-label text-muted">First Name </label>
          <input type="text" class="form-control" id="first-name" required>
          <span class='error-block' hidden>This field is required</span>
        </div>
        <div class="mb-3">
          <label for="last-name" class="form-label text-muted">Last Name</label>
          <input type="text" class="form-control" id="last-name" required>
          <span class='error-block' hidden>This field is required</span>
        </div>
        <div class="mb-3">
          <label for="description" class="form-label text-muted" >Short Description</label>
          <textarea class="form-control" id="description" required></textarea>
          <span class='error-block' hidden>This field is required</span>
        </div>
        <div class="mb-3">
          <label for="email-address" class="form-label text-muted">Email address</label>
          <input type="email" class="form-control" id="email-address" pattern='[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$' placeholder="email@example.com" required>
          <span id='email-error' class='error-block' hidden>Please enter a valid email</span>
        </div>
        <div class="mb-3">
          <label class="btn btn-outline-primary" for="image-file"> <input type="file" id='image-file' hidden>Add Image</label>
          <button class="btn btn-primary" type='button' data-bs-toggle='modal' data-bs-target='#success-modal' id='save-btn' disabled>Save</button>
        </div>
      </form>
    </div>
    <div id='previews'>
    </div>
    <div class='modal fade' id='success-modal'>
    <div class='modal-dialog modal-dialog-centered'>
      <div class='modal-content'>
        <div class='modal-header bg-blue'>
          <h5 class='modal-title text-centered text-white'> <i class="bi bi-send-check text-white"></i> Email Sent</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class='modal-body'>
          <p> Email is successfully sent. Please check your inbox for the form details.</p>
        </div>
      </div>
    </div>
    </div>
  </div>
</body>
<script type='text/javascript'>
  const form = document.getElementById('simple-form');
  const imageFile = document.getElementById('image-file');
  const saveBtn = document.getElementById('save-btn');
  const firstName = document.getElementById('first-name');
  const lastName = document.getElementById('last-name');
  const description = document.getElementById('description');
  const email = document.getElementById('email-address');
  const successModal = new bootstrap.Modal('#success-modal', {
    keyboard: false
  });
  imageFile.addEventListener('change',previewImage);
  firstName.addEventListener('input',validateField);
  lastName.addEventListener('input',validateField);
  description.addEventListener('input',validateField);
  email.addEventListener('input',validateField );


  function previewImage(ev){
    if(!ev.target.files) return;
    let filename = ev.target.files[0].name;
    var reader = new FileReader();
    reader.onload = function(e) {
      const parent = document.getElementById('previews');
      const img = document.createElement('img');
      img.src = e.target.result;
      img.setAttribute('class','img-size me-3');
      parent.appendChild(img);
      document.getElementById('image-file').value='';
    };
    reader.readAsDataURL(ev.target.files[0]);
  }

  function toggleSave(){
    if(firstName.value && lastName.value && description.value && email.value){
      document.getElementById('save-btn').disabled=false;
    }
    else{
      document.getElementById('save-btn').disabled=true;
    }
  }

  function validateField(ev){
    toggleSave();
    let element = ev.target;
    if(element.validity.valid){
      element.parentElement.querySelector('.error-block').hidden=true;
      if(element.classList.contains('danger')) element.classList.remove('danger');
    } else if(ev.target.validity.valueMissing || (element.id='email-address' && element.validity.patternMismatch)){
      element.parentElement.querySelector('.error-block').hidden=false;
      element.classList.add('danger');
      event.preventDefault();
    }
  }
</script>
</html>